
# WavNoiseReduction

## 1. 前置条件

在编译和运行程序之前，请确保已安装所需的依赖项。在 Linux 系统中，您可以使用以下命令安装它们：

```sh
sudo apt install libspeexdsp-dev
```

此外，程序依赖于 **[RNNoise](https://github.com/xiph/rnnoise)** 进行降噪。请确保在使用该程序之前构建并链接 **RNNoise**。

## 2. 编译

要编译程序，可以使用提供的 `build.sh` 脚本。根据系统架构使用以下命令：

### 对于 x64:
```sh
./build.sh x64
```

### 对于 arm64:
```sh
./build.sh arm64
```

## 3. 运行程序

程序编译和依赖项安装完成后，可以从终端运行程序。使用方式如下：

```sh
./WavNoiseReduction input.wav output.wav
```

- `input.wav`：输入的音频文件（必须是WAV格式）。
- `output.wav`：处理后的音频输出文件。

## 4. 配置文件（`config.ini`）

程序读取名为 `config.ini` 的配置文件来加载各种设置。如果此文件不存在，程序会生成一个默认的配置文件。您可以修改该文件中的设置来改变程序的行为。

示例 `config.ini` 文件：

```ini
[settings]
enable_noise_gate = 1
enable_filter = 1
enable_compression = 1
threshold_dbfs = -25
hold_frames = 8
compression_threshold = 25000
enable_denoise = 1
```

### 4.1 配置文件解释

`config.ini` 中的项目控制程序的音频处理设置。以下是每个设置的解释：

### 1. `enable_noise_gate`

  该设置决定是否对音频应用 **噪声门**。**噪声门** 会减少低于设定阈值的音频信号的音量，基本上会消除静音或背景噪音。

  - **启用时** (`1`): 低于指定阈值（以 dBFS 为单位）的音频信号将被静音，这对去除低水平的背景噪音或静音部分非常有用。
  - **禁用时** (`0`): 不应用噪声门，所有音频（包括背景噪音）都将被处理。

---

### 2. `enable_filter`

  该设置决定是否在音频处理中启用 **滤波**。滤波通常涉及去除或减少某些频率，如高频噪声或不需要的声音。

  - **启用时** (`1`): 会应用各种类型的滤波（例如低通或高通滤波器），以减少噪音或不需要的频率。
  - **禁用时** (`0`): 不应用任何滤波，音频将保留原始的频率内容。

---

### 3. `enable_compression`

  该设置决定是否对音频信号应用 **动态压缩**。压缩通过降低大声部分的音量并提高安静部分的音量来减少动态范围。

  - **启用时** (`1`): 音频信号将被压缩，以防止大声部分过于响亮，并提高安静部分的音量，使整体音量更加一致。
  - **禁用时** (`0`): 音频信号不进行压缩，保留音频的原始动态范围，这可能会导致大声部分出现失真或削波。

---

### 4. `threshold_dbfs`

  该设置定义了噪声门的 **阈值**，单位为 **dBFS（满幅度相对分贝）**，低于此阈值的音频信号将被视为背景噪音并静音。

  - **典型值**: 例如 **-25** 表示任何低于 **-25 dBFS** 的音频信号都将被噪声门静音。

---

### 5. `hold_frames`

  该设置决定噪声门在检测到超过阈值的音频后，应该保持打开的 **帧数**。本质上，它设置了噪声门在检测到声音后保持打开的时长。

  - **典型值**: 例如 **8** 表示噪声门在检测到音频超过阈值后，将保持打开 **8 帧**。

---

### 6. `compression_threshold`

  该设置定义了动态压缩的 **阈值**，超过该阈值的音频信号将被压缩。音频信号超过此阈值时，音量会被减少，以防止削波或失真。

  - **典型值**: 例如 **25000** 表示任何音频超过 **25000** 的信号将会被压缩。

---

### 7. `enable_denoise`

  该设置控制是否对音频应用 **降噪** 处理。**降噪** 是去除音频信号中不需要的噪声的过程，通常包括去除背景嗡嗡声、静电噪声或其他不良的声音伪影。

  - **启用时** (`1`): 音频信号将进行 **降噪** 处理，识别并去除音频中的噪声。这对于在嘈杂环境中或录音有背景干扰的情况下，能够提高音频的清晰度。
  - **禁用时** (`0`): 不进行降噪处理，保留音频中的原始噪声。在某些情况下，保留噪声可能有助于保持音频的真实感，避免降噪过程中失去重要的细节。
